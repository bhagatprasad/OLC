@{

    ViewData["Title"] = "Request Money-Request your payment on anytime, anywhere in the world.";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!-- Enhanced Content -->
<div id="content" class="py-5">
    <!-- Animated Background -->
    <div class="position-fixed top-0 start-0 w-100 h-100 z-n1">
        <div class="floating-shapes">
            <div class="shnape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <div class="container position-relative z-1">
        <!-- Page Header -->
        <div class="row justify-content-center mb-5">
            <div class="col-lg-8 text-center">
                <div class="page-header">
                    <span class="badge bg-primary-soft text-primary rounded-pill px-3 py-2 mb-3">
                        <i class="fas fa-bolt me-2"></i>Quick & Easy
                    </span>
                    <h1 class="display-5 fw-bold mb-3">Request Payments in <span class="text-gradient-primary">Minutes</span></h1>
                    <p class="lead text-muted mb-4">
                        Send professional payment requests to anyone, anywhere in the world. Get paid faster with automated reminders.
                    </p>

                    <!-- Stats Row -->
                    <div class="d-flex flex-wrap justify-content-center gap-4 mb-4">
                        <div class="stat-badge">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <span>No Fees for Requestor</span>
                        </div>
                        <div class="stat-badge">
                            <i class="fas fa-shield-alt text-info me-2"></i>
                            <span>Secure & Encrypted</span>
                        </div>
                        <div class="stat-badge">
                            <i class="fas fa-clock text-warning me-2"></i>
                            <span>Instant Notifications</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Process Steps -->
                <div class="process-steps-card card border-0 shadow-lg mb-5">
                    <div class="card-body p-4">
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="process-step active">
                                    <div class="step-number">1</div>
                                    <h6 class="mt-3 mb-2">Enter Details</h6>
                                    <p class="text-muted small">Fill payer information</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="process-step">
                                    <div class="step-number">2</div>
                                    <h6 class="mt-3 mb-2">Set Amount</h6>
                                    <p class="text-muted small">Choose currency & amount</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="process-step">
                                    <div class="step-number">3</div>
                                    <h6 class="mt-3 mb-2">Send Request</h6>
                                    <p class="text-muted small">Review & send</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Request Form -->
                <div class="request-form-wrapper">
                    <div class="card border-0 shadow-xl overflow-hidden">
                        <!-- Form Header -->
                        <div class="card-header bg-gradient-primary text-white p-4">
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <h3 class="h4 mb-1"><i class="fas fa-hand-holding-usd me-2"></i>Create Payment Request</h3>
                                    <p class="mb-0 opacity-75">Fill the details below to request payment</p>
                                </div>
                                <div class="form-badge">
                                    <span class="badge bg-white text-primary">Step 1 of 3</span>
                                </div>
                            </div>
                        </div>

                        <!-- Form Body -->
                        <div class="card-body p-4 p-lg-5">
                            <form id="requestMoneyForm" method="post" class="needs-validation" novalidate>
                                <!-- Payer Details Section -->
                                <div class="form-section mb-5">
                                    <div class="section-header mb-4">
                                        <h4 class="fw-bold d-flex align-items-center">
                                            <div class="section-icon bg-primary-soft text-primary rounded-circle p-2 me-3">
                                                <i class="fas fa-user-circle"></i>
                                            </div>
                                            Payer Details
                                        </h4>
                                        <p class="text-muted mb-0">Enter the person or business you're requesting payment from</p>
                                    </div>

                                    <div class="row g-4">
                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <input type="text" class="form-control" id="payerName" placeholder="Full Name" required>
                                                <label for="payerName">
                                                    <i class="fas fa-user me-2 text-primary"></i>Full Name
                                                </label>
                                                <div class="invalid-feedback">
                                                    Please enter payer's name
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <input type="email" class="form-control" id="payerEmail" placeholder="Email Address" required>
                                                <label for="payerEmail">
                                                    <i class="fas fa-envelope me-2 text-primary"></i>Email Address
                                                </label>
                                                <div class="invalid-feedback">
                                                    Please enter a valid email address
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="form-floating">
                                                <input type="text" class="form-control" id="payerPhone" placeholder="Phone Number">
                                                <label for="payerPhone">
                                                    <i class="fas fa-phone me-2 text-primary"></i>Phone Number (Optional)
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="form-floating">
                                                <select class="form-select" id="inputCountry" required>
                                                    <option value="">Select Country</option>
                                                    <option value="IN">India</option>
                                                    <option value="US">United States</option>
                                                    <option value="GB">United Kingdom</option>
                                                    <option value="AE">United Arab Emirates</option>
                                                    <option value="SG">Singapore</option>
                                                    <option value="AU">Australia</option>
                                                    <option value="CA">Canada</option>
                                                    <option value="DE">Germany</option>
                                                    <option value="FR">France</option>
                                                    <option value="JP">Japan</option>
                                                    <optgroup label="Other Countries">
                                                        <option value="99">India</option>
                                                        <option value="223">United States</option>
                                                        <option value="222">United Kingdom</option>
                                                        <!-- Add other countries as needed -->
                                                    </optgroup>
                                                </select>
                                                <label for="inputCountry">
                                                    <i class="fas fa-globe me-2 text-primary"></i>Country
                                                </label>
                                                <div class="invalid-feedback">
                                                    Please select a country
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Amount Section -->
                                <div class="form-section mb-5">
                                    <div class="section-header mb-4">
                                        <h4 class="fw-bold d-flex align-items-center">
                                            <div class="section-icon bg-success-soft text-success rounded-circle p-2 me-3">
                                                <i class="fas fa-money-bill-wave"></i>
                                            </div>
                                            Amount Details
                                        </h4>
                                        <p class="text-muted mb-0">Set the amount and currency for your payment request</p>
                                    </div>

                                    <div class="row g-4">
                                        <div class="col-md-8">
                                            <div class="form-floating">
                                                <div class="input-group">
                                                    <div class="form-floating flex-grow-1">
                                                        <input type="text" class="form-control amount-input" id="amount" placeholder="Amount" value="1,000.00" required>
                                                        <label for="amount">
                                                            <i class="fas fa-coins me-2 text-primary"></i>Amount
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-floating">
                                                <select class="form-select currency-select" id="currency" required>
                                                    <option value="USD">USD - US Dollar</option>
                                                    <option value="INR" selected>INR - Indian Rupee</option>
                                                    <option value="EUR">EUR - Euro</option>
                                                    <option value="GBP">GBP - British Pound</option>
                                                    <option value="AED">AED - UAE Dirham</option>
                                                    <option value="AUD">AUD - Australian Dollar</option>
                                                    <option value="CAD">CAD - Canadian Dollar</option>
                                                    <option value="SGD">SGD - Singapore Dollar</option>
                                                    <option value="JPY">JPY - Japanese Yen</option>
                                                </select>
                                                <label for="currency">
                                                    <i class="fas fa-money-bill me-2 text-primary"></i>Currency
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Amount Breakdown -->
                                        <div class="col-12">
                                            <div class="amount-breakdown card border-0 bg-light p-3">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="text-muted">Amount</span>
                                                    <span class="fw-bold" id="displayAmount">₹1,000.00</span>
                                                </div>
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="text-muted">Platform Fee</span>
                                                    <span class="text-success" id="feeAmount">₹0.00</span>
                                                </div>
                                                <div class="d-flex justify-content-between pt-2 border-top">
                                                    <span class="fw-bold">Payer Pays</span>
                                                    <span class="fw-bold text-primary" id="totalAmount">₹1,000.00</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Additional Details -->
                                <div class="form-section mb-5">
                                    <div class="section-header mb-4">
                                        <h4 class="fw-bold d-flex align-items-center">
                                            <div class="section-icon bg-info-soft text-info rounded-circle p-2 me-3">
                                                <i class="fas fa-file-alt"></i>
                                            </div>
                                            Additional Details
                                        </h4>
                                        <p class="text-muted mb-0">Add description and set payment deadline</p>
                                    </div>

                                    <div class="row g-4">
                                        <div class="col-12">
                                            <div class="form-floating">
                                                <textarea class="form-control" id="description" placeholder="Description" style="height: 120px" required></textarea>
                                                <label for="description">
                                                    <i class="fas fa-comment me-2 text-primary"></i>Payment Description
                                                </label>
                                                <div class="invalid-feedback">
                                                    Please enter payment description
                                                </div>
                                                <small class="text-muted mt-1 d-block">What is this payment for? (e.g., Invoice #123, Services Rendered)</small>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <input type="date" class="form-control" id="paymentDue" required>
                                                <label for="paymentDue">
                                                    <i class="fas fa-calendar-alt me-2 text-primary"></i>Payment Due Date
                                                </label>
                                                <div class="invalid-feedback">
                                                    Please select a due date
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <select class="form-select" id="reminderFrequency">
                                                    <option value="none">No Reminders</option>
                                                    <option value="daily">Daily Reminders</option>
                                                    <option value="weekly" selected>Weekly Reminders</option>
                                                    <option value="biweekly">Every 2 Days</option>
                                                    <option value="monthly">Monthly</option>
                                                </select>
                                                <label for="reminderFrequency">
                                                    <i class="fas fa-bell me-2 text-primary"></i>Payment Reminders
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="sendCopy" checked>
                                                <label class="form-check-label" for="sendCopy">
                                                    Send a copy of this request to my email
                                                </label>
                                            </div>
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" type="checkbox" id="allowPartial" checked>
                                                <label class="form-check-label" for="allowPartial">
                                                    Allow partial payments
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Form Actions -->
                                <div class="form-actions mt-5">
                                    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-center">
                                        <div class="mb-3 mb-lg-0">
                                            <a href="@Url.Action("Dashboard", "Account")" class="btn btn-outline-secondary">
                                                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                                            </a>
                                        </div>

                                        <div class="d-flex gap-3">
                                            <button type="button" class="btn btn-outline-primary" id="previewBtn">
                                                <i class="fas fa-eye me-2"></i>Preview Request
                                            </button>
                                            <button type="submit" class="btn btn-primary btn-lg px-5">
                                                <i class="fas fa-paper-plane me-2"></i>Send Request
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Form Footer -->
                        <div class="card-footer bg-light border-0 p-4">
                            <div class="security-notice">
                                <div class="d-flex align-items-center">
                                    <div class="security-icon me-3">
                                        <i class="fas fa-shield-alt fa-2x text-success"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">Secure & Encrypted</h6>
                                        <p class="text-muted small mb-0">
                                            Your payment request details are protected with bank-level 256-bit encryption.
                                            We never share your information with third parties.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Tips -->
                <div class="quick-tips mt-5">
                    <div class="row g-4">
                        <div class="col-md-4">
                            <div class="tip-card text-center p-4">
                                <div class="tip-icon bg-primary-soft text-primary rounded-circle p-3 mb-3 mx-auto">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <h5 class="fw-bold mb-2">Instant Delivery</h5>
                                <p class="text-muted small mb-0">Requests are delivered instantly via email & SMS</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="tip-card text-center p-4">
                                <div class="tip-icon bg-success-soft text-success rounded-circle p-3 mb-3 mx-auto">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h5 class="fw-bold mb-2">Track Payments</h5>
                                <p class="text-muted small mb-0">Real-time tracking of payment status</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="tip-card text-center p-4">
                                <div class="tip-icon bg-warning-soft text-warning rounded-circle p-3 mb-3 mx-auto">
                                    <i class="fas fa-headset"></i>
                                </div>
                                <h5 class="fw-bold mb-2">24/7 Support</h5>
                                <p class="text-muted small mb-0">Get help anytime with our support team</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Preview Modal -->
<div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-gradient-primary text-white">
                <h5 class="modal-title">
                    <i class="fas fa-eye me-2"></i>Payment Request Preview
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
                <div class="preview-content">
                    <!-- Preview will be dynamically inserted here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="sendNowBtn">
                    <i class="fas fa-paper-plane me-2"></i>Send Now
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Success Toast -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="successToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
            <i class="fas fa-check-circle me-2"></i>
            <strong class="me-auto">Success!</strong>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            Payment request has been sent successfully!
        </div>
    </div>
</div>

<script src="~/js/jquery/jquery.min.js"></script>

<script>
    $(function () {
        // Initialize form validation
        const form = document.getElementById('requestMoneyForm');
        const previewBtn = document.getElementById('previewBtn');
        const previewModal = new bootstrap.Modal(document.getElementById('previewModal'));
        const sendNowBtn = document.getElementById('sendNowBtn');
        const successToast = new bootstrap.Toast(document.getElementById('successToast'));

        // Form validation
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            } else {
                event.preventDefault();
                // Simulate form submission
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    successToast.show();
                    form.reset();
                    // Reset form validation
                    form.classList.remove('was-validated');
                }, 2000);
            }

            form.classList.add('was-validated');
        }, false);

        // Amount formatting
        const amountInput = document.getElementById('amount');
        const displayAmount = document.getElementById('displayAmount');
        const feeAmount = document.getElementById('feeAmount');
        const totalAmount = document.getElementById('totalAmount');
        const currencySelect = document.getElementById('currency');

        function formatAmount(value) {
            // Remove non-numeric characters
            let num = value.replace(/[^\d.]/g, '');

            // Format with commas
            if (num) {
                num = parseFloat(num).toLocaleString('en-IN', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
            }

            return num;
        }

        function updateAmounts() {
            const amount = parseFloat(amountInput.value.replace(/[^\d.]/g, '')) || 0;
            const currency = currencySelect.value;
            const currencySymbol = getCurrencySymbol(currency);
            const fee = calculateFee(amount);
            const total = amount + fee;

            // Update displays
            displayAmount.textContent = `${currencySymbol}${amount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}`;
            feeAmount.textContent = `${currencySymbol}${fee.toLocaleString('en-IN', { minimumFractionDigits: 2 })}`;
            totalAmount.textContent = `${currencySymbol}${total.toLocaleString('en-IN', { minimumFractionDigits: 2 })}`;
        }

        function getCurrencySymbol(currency) {
            const symbols = {
                'INR': '₹',
                'USD': '$',
                'EUR': '€',
                'GBP': '£',
                'AED': 'د.إ',
                'AUD': 'A$',
                'CAD': 'C$',
                'SGD': 'S$',
                'JPY': '¥'
            };
            return symbols[currency] || currency;
        }

        function calculateFee(amount) {
            // Calculate 2% fee with minimum of currency specific amount
            const fee = amount * 0.02;
            return Math.max(fee, 0); // Minimum fee logic
        }

        amountInput.addEventListener('input', function() {
            this.value = formatAmount(this.value);
            updateAmounts();
        });

        currencySelect.addEventListener('change', updateAmounts);

        // Set default due date (7 days from now)
        const today = new Date();
        const nextWeek = new Date(today);
        nextWeek.setDate(today.getDate() + 7);
        document.getElementById('paymentDue').valueAsDate = nextWeek;

        // Initialize amounts
        updateAmounts();

        // Preview functionality
        previewBtn.addEventListener('click', function() {
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            // Gather form data
            const formData = {
                payerName: document.getElementById('payerName').value,
                payerEmail: document.getElementById('payerEmail').value,
                payerPhone: document.getElementById('payerPhone').value,
                country: document.getElementById('inputCountry').options[document.getElementById('inputCountry').selectedIndex].text,
                amount: amountInput.value,
                currency: currencySelect.options[currencySelect.selectedIndex].text,
                description: document.getElementById('description').value,
                dueDate: document.getElementById('paymentDue').value,
                reminders: document.getElementById('reminderFrequency').options[document.getElementById('reminderFrequency').selectedIndex].text
            };

            // Generate preview HTML
            const previewHTML = `
                <div class="p-4">
                    <div class="preview-header text-center mb-4">
                        <i class="fas fa-file-invoice-dollar fa-3x text-primary mb-3"></i>
                        <h4 class="fw-bold">Payment Request Preview</h4>
                        <p class="text-muted">Review before sending</p>
                    </div>

                    <div class="preview-details">
                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>To:</strong>
                            </div>
                            <div class="col-6 text-end">
                                ${formData.payerName}
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Email:</strong>
                            </div>
                            <div class="col-6 text-end">
                                ${formData.payerEmail}
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Country:</strong>
                            </div>
                            <div class="col-6 text-end">
                                ${formData.country}
                            </div>
                        </div>

                        <hr>

                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Amount:</strong>
                            </div>
                            <div class="col-6 text-end">
                                <h5 class="fw-bold text-primary">${getCurrencySymbol(formData.currency.split(' - ')[0])}${parseFloat(formData.amount.replace(/[^\d.]/g, '')).toLocaleString('en-IN', { minimumFractionDigits: 2 })}</h5>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Currency:</strong>
                            </div>
                            <div class="col-6 text-end">
                                ${formData.currency}
                            </div>
                        </div>

                        <div class="row mb-4">
                            <div class="col-6">
                                <strong>Due Date:</strong>
                            </div>
                            <div class="col-6 text-end">
                                ${new Date(formData.dueDate).toLocaleDateString('en-IN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                            </div>
                        </div>

                        <div class="mb-4">
                            <strong>Description:</strong>
                            <div class="mt-2 p-3 bg-light rounded">
                                ${formData.description}
                            </div>
                        </div>

                        <div class="mb-3">
                            <strong>Payment Reminders:</strong>
                            <div class="mt-2">
                                <span class="badge bg-primary">${formData.reminders}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.querySelector('.preview-content').innerHTML = previewHTML;
            previewModal.show();
        });

        // Send from preview
        sendNowBtn.addEventListener('click', function() {
            previewModal.hide();
            form.dispatchEvent(new Event('submit'));
        });

        // Country search enhancement
        const countrySelect = document.getElementById('inputCountry');
        const countrySearch = document.createElement('input');
        countrySearch.type = 'text';
        countrySearch.className = 'form-control mb-3';
        countrySearch.placeholder = 'Search country...';

        countrySelect.parentNode.insertBefore(countrySearch, countrySelect);

        countrySearch.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const options = countrySelect.options;

            for (let i = 0; i < options.length; i++) {
                const option = options[i];
                const text = option.text.toLowerCase();
                option.style.display = text.includes(searchTerm) ? '' : 'none';
            }
        });

        // Loading animation functions
        function showLoading() {
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending...';
            submitBtn.disabled = true;
            submitBtn.classList.add('loading');
        }

        function hideLoading() {
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Send Request';
            submitBtn.disabled = false;
            submitBtn.classList.remove('loading');
        }

        // Animate form sections on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animationPlayState = 'running';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.form-section').forEach(section => {
            observer.observe(section);
        });
    });
</script>